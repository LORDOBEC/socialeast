<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Kanit', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .content {
            padding: 30px;
        }

        .upload-section {
            margin-bottom: 25px;
            padding: 20px;
            background: linear-gradient(135deg, #e3f2fd, #f3e5f5);
            border-radius: 15px;
            border: 2px dashed #667eea;
            transition: all 0.3s ease;
        }

        .upload-section:hover {
            border-color: #5a67d8;
            background: linear-gradient(135deg, #dbeafe, #ede9fe);
        }

        .file-input-wrapper {
            position: relative;
            display: inline-block;
            width: 100%;
            margin-top: 10px;
        }

        .file-input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-input:hover {
            border-color: #667eea;
        }

        .upload-status {
            margin-top: 15px;
            padding: 10px;
            border-radius: 8px;
            font-size: 0.9rem;
        }

        .status-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status-processing {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .info-box {

        .search-container {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .search-input {
            flex: 1;
            padding: 15px 20px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .search-button {
            padding: 15px 25px;
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .search-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }

        .stats {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .stat-card {
            background: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            text-align: center;
            min-width: 120px;
        }

        .stat-number {
            font-size: 1.8rem;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #6c757d;
            margin-top: 5px;
        }

        .result-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-left: 5px solid #667eea;
            transition: all 0.3s ease;
        }

        .result-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .result-rank {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .result-name {
            font-size: 1.3rem;
            font-weight: bold;
            color: #495057;
            flex-grow: 1;
            margin-left: 15px;
        }

        .result-details {
            color: #6c757d;
            font-size: 1rem;
            margin-top: 5px;
        }

        .no-results {
            text-align: center;
            padding: 40px;
            color: #6c757d;
            font-size: 1.1rem;
        }

        .search-section {
            margin-bottom: 30px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            border: 2px dashed #e9ecef;
        }
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        @media (max-width: 768px) {
            .search-container {
                flex-direction: column;
            }
            
            .result-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .result-name {
                margin-left: 0;
                margin-top: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéì ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h1>
            <p>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏°‡πÄ‡∏ä‡∏¥‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£ ‡∏õ‡∏µ 2568</p>
        </div>

        <div class="content">
            <div class="info-box">
                <strong>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:</strong> ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏ö‡∏£‡∏°‡πÄ‡∏ä‡∏¥‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£ ‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ‡∏û.‡∏®. 2568<br>
                <strong>‡∏Å‡∏•‡∏∏‡πà‡∏°:</strong> ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© ‡πÅ‡∏•‡∏∞‡∏†‡∏≤‡∏©‡∏≤‡∏à‡∏µ‡∏ô<br>
                <strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ‚úì
            </div>

            <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î PDF -->
            <div class="upload-section">
                <h3>üìÑ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå PDF ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</h3>
                <p style="color: #6c757d; margin-bottom: 15px;">
                    ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå PDF ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥<br>
                    <strong>‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö:</strong> ‡∏•‡∏≥‡∏î‡∏±‡∏ö ‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î
                </p>
                <div class="file-input-wrapper">
                    <input type="file" id="pdfUpload" class="file-input" accept=".pdf">
                </div>
                <div id="uploadStatus" class="upload-status" style="display: none;"></div>
            </div>

            <div class="search-section">
                <h3>üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
                <div class="search-container">
                    <input type="text" id="searchInput" class="search-input" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô...">
                    <button id="searchButton" class="search-button">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
                </div>
                
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-number" id="totalCount">35</div>
                        <div class="stat-label">‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="foundCount">0</div>
                        <div class="stat-label">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</div>
                    </div>
                </div>

                <div id="searchResults"></div>
            </div>
        </div>
    </div>

    <script>
        // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ PDF.js worker
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á - ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
        const studentsData = [
            {rank: 1, prefix: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", name: "‡∏®‡∏®‡∏¥‡∏Å‡∏≤‡∏ô‡∏ï‡πå ‡∏â‡∏≤‡∏¢‡πÅ‡∏™‡∏á", school: "‡∏®‡∏£‡∏µ‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", province: "‡πÄ‡∏•‡∏¢", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©"},
            {rank: 2, prefix: "‡∏ô‡∏≤‡∏¢", name: "‡∏û‡∏∏‡∏ó‡∏ò‡∏¥‡∏û‡∏á‡∏©‡πå ‡∏≠‡∏¥‡∏ô‡∏ó‡∏∞‡∏™‡∏≠‡∏ô", school: "‡∏®‡∏£‡∏µ‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", province: "‡πÄ‡∏•‡∏¢", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©"},
            {rank: 3, prefix: "‡∏ô‡∏≤‡∏¢", name: "‡∏û‡∏á‡∏®‡∏Å‡∏£ ‡∏™‡∏∏‡∏ô‡∏ó‡∏£‡∏ß‡∏á‡∏©‡πå", school: "‡∏®‡∏£‡∏µ‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", province: "‡πÄ‡∏•‡∏¢", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©"},
            {rank: 4, prefix: "‡∏ô‡∏≤‡∏¢", name: "‡∏£‡∏±‡∏ê‡∏†‡∏π‡∏°‡∏¥ ‡πÑ‡∏Å‡∏£‡∏ß‡∏±‡∏ô", school: "‡∏®‡∏£‡∏µ‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", province: "‡πÄ‡∏•‡∏¢", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©"},
            {rank: 5, prefix: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", name: "‡∏ä‡∏•‡∏ò‡∏¥‡∏ä‡∏≤ ‡∏à‡∏∏‡∏ï‡∏ï‡πÇ‡∏ô", school: "‡∏®‡∏£‡∏µ‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", province: "‡πÄ‡∏•‡∏¢", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©"},
            {rank: 6, prefix: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", name: "‡∏°‡∏¥‡∏ô‡∏ï‡∏£‡∏≤ ‡∏≠‡∏∂‡πà‡∏á‡∏õ‡∏≤", school: "‡∏®‡∏£‡∏µ‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", province: "‡πÄ‡∏•‡∏¢", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©"},
            {rank: 7, prefix: "‡∏ô‡∏≤‡∏¢", name: "‡∏ô‡∏¥‡∏ï‡∏¥‡∏ò‡∏£ ‡∏™‡∏£‡πâ‡∏≠‡∏¢‡∏Ñ‡∏£‡∏ö‡∏∏‡∏£‡∏µ", school: "‡∏Å‡∏°‡∏•‡∏≤‡πÑ‡∏™‡∏¢", province: "‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©"},
            {rank: 8, prefix: "‡∏ô‡∏≤‡∏¢", name: "‡∏≠‡∏ò‡∏¥‡∏Å‡∏≤‡∏£ ‡∏ú‡∏•‡∏∞‡∏û‡∏•", school: "‡∏®‡∏£‡∏µ‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", province: "‡πÄ‡∏•‡∏¢", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©"},
            {rank: 9, prefix: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", name: "‡∏õ‡∏∏‡∏©‡∏¢‡∏≤ ‡∏õ‡∏±‡∏ì‡∏ì‡∏ß‡∏±‡∏í‡∏ô‡πå", school: "‡∏®‡∏£‡∏µ‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", province: "‡πÄ‡∏•‡∏¢", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©"},
            {rank: 10, prefix: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", name: "‡∏ô‡∏≤‡∏ß‡∏™‡∏≤‡∏ß‡∏Å‡∏±‡∏ç‡∏ç‡∏≤‡∏û‡∏±‡∏ä‡∏£‡πå ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏ñ‡∏¥‡∏£‡∏Å‡∏∏‡∏•", school: "‡∏®‡∏£‡∏µ‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", province: "‡πÄ‡∏•‡∏¢", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©"},
            {rank: 14, prefix: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", name: "‡∏ä‡∏≤‡∏•‡∏¥‡∏™‡∏≤ ‡∏û‡∏≠‡∏Å‡πÄ‡∏û‡∏µ‡∏¢‡∏£", school: "‡∏™‡∏¥‡∏£‡∏¥‡∏ô‡∏ò‡∏£", province: "‡∏™‡∏∏‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©"},
            {rank: 19, prefix: "‡∏ô‡∏≤‡∏¢", name: "‡∏Å‡∏¥‡∏ï‡∏ï‡∏¥‡∏Å‡∏≤‡∏ô‡∏ï‡πå ‡πÅ‡∏•‡∏ú‡∏î‡∏∏‡∏á", school: "‡∏™‡∏¥‡∏£‡∏¥‡∏ô‡∏ò‡∏£", province: "‡∏™‡∏∏‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©"},
            {rank: 100, prefix: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", name: "‡∏™‡∏Å‡∏≤‡∏ß‡∏£‡∏±‡∏ï‡∏ô‡πå ‡∏à‡∏¥‡∏ï‡∏°‡∏≤‡∏ï‡∏¢‡πå", school: "‡∏õ‡∏•‡∏≤‡∏õ‡∏≤‡∏Å‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", province: "‡∏ô‡∏Ñ‡∏£‡∏û‡∏ô‡∏°", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©"},
            {rank: 150, prefix: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", name: "‡∏ä‡∏•‡∏ó‡∏¥‡∏ä‡∏≤ ‡πÅ‡∏™‡∏ô‡∏ó‡∏ß‡∏µ‡∏™‡∏ß‡∏µ‡∏™‡∏∏‡∏Ç", school: "‡∏õ‡∏•‡∏≤‡∏õ‡∏≤‡∏Å‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", province: "‡∏ô‡∏Ñ‡∏£‡∏û‡∏ô‡∏°", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©"},
            {rank: 200, prefix: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", name: "‡∏ò‡∏µ‡∏£‡∏Å‡∏≤‡∏ô‡∏ï‡πå ‡∏≠‡∏∏‡∏ï‡∏¥‡∏•‡∏≤", school: "‡∏õ‡∏•‡∏≤‡∏õ‡∏≤‡∏Å‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", province: "‡∏ô‡∏Ñ‡∏£‡∏û‡∏ô‡∏°", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©"},
            
            // ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏†‡∏≤‡∏©‡∏≤‡∏à‡∏µ‡∏ô
            {rank: 254, prefix: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", name: "‡∏ä‡∏•‡∏ò‡∏¥‡∏ä‡∏≤ ‡∏ô‡∏Ñ‡∏£‡∏Ç‡∏ß‡∏≤‡∏á", school: "‡∏®‡∏£‡∏µ‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", province: "‡πÄ‡∏•‡∏¢", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏à‡∏µ‡∏ô"},
            {rank: 255, prefix: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", name: "‡∏≠‡∏¥‡∏á‡∏£‡∏±‡∏Å ‡πÅ‡∏Å‡πâ‡∏ß‡∏®‡∏¥‡∏•‡∏≤", school: "‡∏®‡∏£‡∏µ‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", province: "‡πÄ‡∏•‡∏¢", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏à‡∏µ‡∏ô"},
            {rank: 256, prefix: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", name: "‡∏™‡∏∏‡∏ò‡∏≤‡∏ò‡∏¥‡∏á‡∏©‡πå ‡∏ï‡∏¥‡∏™‡∏±‡∏ô‡πÄ‡∏ó‡∏µ‡∏¢‡∏∞", school: "‡∏®‡∏£‡∏µ‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", province: "‡πÄ‡∏•‡∏¢", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏à‡∏µ‡∏ô"},
            {rank: 257, prefix: "‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á", name: "‡∏Ñ‡∏∏‡∏ì‡∏±‡∏ä‡∏ç‡∏≤ ‡∏™‡∏≤‡∏¢‡πÄ‡∏°‡∏∑‡∏≠‡∏á", school: "‡∏®‡∏£‡∏µ‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", province: "‡πÄ‡∏•‡∏¢", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏à‡∏µ‡∏ô"},
            {rank: 258, prefix: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", name: "‡πÄ‡∏û‡∏ä‡∏£‡∏£‡∏±‡∏ï‡∏ô‡πå ‡∏û‡∏£‡∏°‡∏®‡∏≤‡∏ï‡∏£‡πå", school: "‡∏®‡∏£‡∏µ‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", province: "‡πÄ‡∏•‡∏¢", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏à‡∏µ‡∏ô"},
            {rank: 300, prefix: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", name: "‡∏õ‡∏¥‡∏¢‡∏ò‡∏¥‡∏î‡∏≤ ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏™‡∏∏‡∏ó‡∏ò‡∏¥", school: "‡∏≠‡∏∏‡∏î‡∏£‡∏û‡∏¥‡∏ä‡∏±‡∏¢‡∏£‡∏±‡∏Å‡∏©‡πå‡∏û‡∏¥‡∏ó‡∏¢‡∏≤", province: "‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏à‡∏µ‡∏ô"},
            {rank: 350, prefix: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", name: "‡∏ß‡∏¥‡∏à‡∏¥‡∏ï‡∏£‡∏à‡∏ô‡∏≤ ‡∏™‡∏¥‡∏á‡∏´‡πå‡∏ß‡∏á‡∏®‡πå", school: "‡∏ô‡∏≤‡∏á‡∏£‡∏≠‡∏á‡∏û‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°", province: "‡∏ö‡∏∏‡∏£‡∏µ‡∏£‡∏±‡∏°‡∏¢‡πå", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏à‡∏µ‡∏ô"},
            {rank: 400, prefix: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", name: "‡∏Ç‡∏ß‡∏±‡∏ç‡∏Ç‡πâ‡∏≤‡∏ß ‡∏ó‡∏≠‡∏á‡∏ô‡∏∏‡∏ä", school: "‡∏≠‡∏∏‡∏î‡∏£‡∏û‡∏¥‡∏ó‡∏¢‡∏≤‡∏ô‡∏∏‡∏Å‡∏π‡∏•", province: "‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏à‡∏µ‡∏ô"},
            {rank: 420, prefix: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", name: "‡∏û‡∏¥‡∏ä‡∏ç‡∏≤‡∏†‡∏≤ ‡∏ô‡∏≤‡∏°‡∏õ‡∏±‡∏î‡∏™‡∏≤", school: "‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢", province: "‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏à‡∏µ‡∏ô"},
            {rank: 450, prefix: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", name: "‡∏à‡∏¥‡∏£‡∏≤‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡πå ‡∏û‡∏≤‡∏•‡∏∂‡∏Å", school: "‡∏°‡∏∏‡∏Å‡∏î‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏ô‡∏∏‡∏Å‡∏π‡∏•", province: "‡∏°‡∏∏‡∏Å‡∏î‡∏≤‡∏´‡∏≤‡∏£", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏à‡∏µ‡∏ô"},
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
            {rank: 25, prefix: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", name: "‡∏Å‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏±‡∏ê ‡∏î‡∏±‡∏á‡∏Ñ‡∏ô‡∏∂‡∏Å", school: "‡∏™‡∏¥‡∏£‡∏¥‡∏ô‡∏ò‡∏£", province: "‡∏™‡∏∏‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©"},
            {rank: 30, prefix: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", name: "‡∏™‡∏¥‡∏£‡∏¥‡∏ô‡∏î‡∏≤ ‡∏ö‡∏∏‡∏ç‡∏Ñ‡∏∑‡∏ô", school: "‡∏™‡∏¥‡∏£‡∏¥‡∏ô‡∏ò‡∏£", province: "‡∏™‡∏∏‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©"},
            {rank: 50, prefix: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", name: "‡∏Ç‡∏ô‡∏¥‡∏©‡∏ê‡∏≤ ‡∏ô‡∏≤‡πÉ‡∏à‡∏Ñ‡∏á", school: "‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏≠‡∏∏‡∏î‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏†‡∏≤‡∏Ñ‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠", province: "‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©"},
            {rank: 75, prefix: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", name: "‡∏®‡∏®‡∏¥‡∏ß‡∏¥‡∏°‡∏• ‡πÄ‡∏£‡∏∑‡∏≠‡∏á‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå", school: "‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏≠‡∏∏‡∏î‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏†‡∏≤‡∏Ñ‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏â‡∏µ‡∏¢‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠", province: "‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©"},
            {rank: 125, prefix: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", name: "‡∏≠‡∏£‡∏±‡∏ç‡∏ç‡∏≤ ‡∏ß‡∏±‡∏á‡∏ó‡∏∞‡∏û‡∏±‡∏ô‡∏ò‡πå", school: "‡∏õ‡∏•‡∏≤‡∏õ‡∏≤‡∏Å‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", province: "‡∏ô‡∏Ñ‡∏£‡∏û‡∏ô‡∏°", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©"},
            {rank: 175, prefix: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", name: "‡∏õ‡∏ì‡∏¥‡∏ï‡∏≤ ‡πÑ‡∏Å‡∏£‡∏®‡∏£‡∏µ‡∏ß‡∏£‡∏£‡∏ò‡∏ô‡∏∞", school: "‡∏õ‡∏•‡∏≤‡∏õ‡∏≤‡∏Å‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", province: "‡∏ô‡∏Ñ‡∏£‡∏û‡∏ô‡∏°", group: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©"}
        ];

        // ‡πÄ‡∏û‡∏¥‡πà‡∏° fullName ‡πÅ‡∏•‡∏∞ searchName ‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        studentsData.forEach(student => {
            student.fullName = `${student.prefix} ${student.name}`;
            student.searchName = student.name;
        });

        document.getElementById('searchButton').addEventListener('click', searchStudents);
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchStudents();
            }
        });

        // ‡πÄ‡∏û‡∏¥‡πà‡∏° Event Listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î PDF
        document.getElementById('pdfUpload').addEventListener('change', handlePDFUpload);

        function searchStudents() {
            const query = document.getElementById('searchInput').value.trim();
            if (!query) {
                document.getElementById('searchResults').innerHTML = `
                    <div class="no-results">
                        <h3>üí° ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h3>
                        <p><strong>üìÑ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î PDF:</strong> ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå PDF ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</p>
                        <p><strong>üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤:</strong> ‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠ ‡πÄ‡∏ä‡πà‡∏ô "‡∏®‡∏®‡∏¥‡∏Å‡∏≤‡∏ô‡∏ï‡πå"</p>
                        <p><strong>üè´ ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</strong> ‡πÄ‡∏ä‡πà‡∏ô "‡∏®‡∏£‡∏µ‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°"</p>
                        <p><strong>üìç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î:</strong> ‡πÄ‡∏ä‡πà‡∏ô "‡πÄ‡∏•‡∏¢"</p>
                        <hr style="margin: 15px 0;">
                        <p><strong>üíº ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà:</strong></p>
                        <p>‚Ä¢ ‡∏•‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ "‡∏®‡∏®‡∏¥‡∏Å‡∏≤‡∏ô‡∏ï‡πå", "‡∏ä‡∏•‡∏ò‡∏¥‡∏ä‡∏≤", "‡∏õ‡∏•‡∏≤‡∏õ‡∏≤‡∏Å"</p>
                    </div>
                `;
                document.getElementById('foundCount').textContent = '0';
                return;
            }

            const results = fuzzySearch(query, studentsData);
            displayResults(results);
            document.getElementById('foundCount').textContent = results.length;
        }

        function fuzzySearch(query, data) {
            const queryLower = query.toLowerCase();
            const results = [];

            for (const student of data) {
                const nameLower = student.searchName.toLowerCase();
                const fullNameLower = student.fullName.toLowerCase();
                const schoolLower = student.school.toLowerCase();
                const provinceLower = student.province.toLowerCase();
                
                let score = 0;

                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏ü‡∏¥‡∏•‡∏î‡πå
                if (nameLower === queryLower || fullNameLower === queryLower) {
                    score = 100;
                } else if (nameLower.includes(queryLower) || fullNameLower.includes(queryLower)) {
                    score = 90;
                } else if (schoolLower.includes(queryLower)) {
                    score = 70;
                } else if (provinceLower.includes(queryLower)) {
                    score = 60;
                } else {
                    // Fuzzy match ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠
                    const queryWords = queryLower.split(' ').filter(word => word.length > 0);
                    const nameWords = nameLower.split(' ').filter(word => word.length > 0);
                    let matches = 0;

                    for (const queryWord of queryWords) {
                        for (const nameWord of nameWords) {
                            if (nameWord.includes(queryWord) || queryWord.includes(nameWord)) {
                                matches++;
                                break;
                            }
                        }
                    }

                    if (matches > 0) {
                        score = (matches / queryWords.length) * 50;
                    }
                }

                if (score > 0) {
                    results.push({ ...student, score });
                }
            }

            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ï‡∏≤‡∏° score ‡πÅ‡∏•‡∏∞ rank
            results.sort((a, b) => {
                if (b.score !== a.score) {
                    return b.score - a.score;
                }
                return a.rank - b.rank;
            });

            return results;
        }

        function displayResults(results) {
            const resultsContainer = document.getElementById('searchResults');

            if (results.length === 0) {
                resultsContainer.innerHTML = `
                    <div class="no-results">
                        <h3>üòî ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</h3>
                        <p>‡∏•‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏∞‡∏Å‡∏î‡∏ä‡∏∑‡πà‡∏≠ ‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏≠‡∏á‡πÉ‡∏™‡πà‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</p>
                    </div>
                `;
                return;
            }

            let html = '';
            results.forEach(student => {
                html += `
                    <div class="result-card">
                        <div class="result-header">
                            <div class="result-rank">‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà ${student.rank}</div>
                            <div class="result-name">${student.fullName}</div>
                        </div>
                        <div class="result-details">üè´ ${student.school}</div>
                        <div class="result-details">üìç ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î${student.province}</div>
                        <div class="result-details">üë• ‡∏Å‡∏•‡∏∏‡πà‡∏°: ${student.group}</div>
                        <div class="result-details">üìä ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥: ${Math.round(student.score)}%</div>
                    </div>
                `;
            });

            resultsContainer.innerHTML = html;
        }

        // Auto-search ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå
        let searchTimeout;
        document.getElementById('searchInput').addEventListener('input', function() {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                if (this.value.trim().length > 1) {
                    searchStudents();
                } else if (this.value.trim().length === 0) {
                    searchStudents(); // ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥
                }
            }, 300);
        });

        // ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤
        searchStudents();

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î PDF
        async function handlePDFUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            if (file.type !== 'application/pdf') {
                showUploadStatus('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå PDF ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô', 'error');
                return;
            }

            showUploadStatus('‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå PDF...', 'processing');

            try {
                const arrayBuffer = await file.arrayBuffer();
                const pdf = await pdfjsLib.getDocument(arrayBuffer).promise;
                
                let allText = '';
                
                // ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πâ‡∏≤
                for (let pageNum = 1; pageNum <= pdf.numPages; pageNum++) {
                    const page = await pdf.getPage(pageNum);
                    const textContent = await page.getTextContent();
                    const textItems = textContent.items.map(item => item.str).join(' ');
                    allText += textItems + '\n';
                }

                // ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
                const newStudentsData = parsePDFTextToStudents(allText);
                
                console.log("‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏á‡πÑ‡∏î‡πâ:", newStudentsData.slice(0, 3));
                
                if (newStudentsData.length > 0) {
                    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å
                    studentsData.length = 0;
                    studentsData.push(...newStudentsData);
                    
                    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï UI
                    document.getElementById('totalCount').textContent = studentsData.length;
                    showUploadStatus(`‚úÖ ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ ${studentsData.length} ‡∏Ñ‡∏ô`, 'success');
                    
                    // ‡∏•‡πâ‡∏≤‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏î‡∏¥‡∏°
                    document.getElementById('searchResults').innerHTML = '';
                    document.getElementById('foundCount').textContent = '0';
                    
                    // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏ã‡∏•
                    console.log(`‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${studentsData.length} ‡∏Ñ‡∏ô`);
                    console.log('‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 5 ‡∏Ñ‡∏ô‡πÅ‡∏£‡∏Å:', newStudentsData.slice(0, 5));
                    
                    // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
                    const schoolStats = {};
                    newStudentsData.forEach(student => {
                        schoolStats[student.school] = (schoolStats[student.school] || 0) + 1;
                    });
                    console.log('‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:', schoolStats);
                    
                } else {
                    showUploadStatus('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå PDF ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'error');
                    console.log('‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å PDF:', allText.substring(0, 1000));
                }

            } catch (error) {
                console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:', error);
                showUploadStatus('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå PDF', 'error');
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å PDF ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
        function parsePDFTextToStudents(text) {
            const lines = text.split('\n').filter(line => line.trim().length > 0);
            const students = [];

            for (let line of lines) {
                line = line.trim();
                
                // ‡∏Ç‡πâ‡∏≤‡∏°‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÅ‡∏•‡∏∞‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
                if (line.includes('‡∏´‡∏ô‡πâ‡∏≤') || line.includes('‡∏•‡∏≥‡∏î‡∏±‡∏ö') || line.includes('‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤') || 
                    line.includes('‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•') || line.includes('‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô') || line.includes('‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î') ||
                    line.includes('‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤') || line.includes('‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ') || 
                    line.includes('‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡πÄ‡∏™‡∏≤‡∏£‡πå') || line.includes('‡∏†‡∏≤‡∏Ñ‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å') ||
                    line.includes('‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô') || line.length < 15) {
                    continue;
                }

                // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏Å: ‡∏•‡∏≥‡∏î‡∏±‡∏ö ‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ ‡∏ä‡∏∑‡πà‡∏≠ ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î
                let match = line.match(/^(\d+)\s+(‡∏ô‡∏≤‡∏¢|‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß|‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢|‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á|‡∏ô\.‡∏™)\s+(.+?)\s+(.+?)\s+([\u0E00-\u0E7F\s]+(?:‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤|‡∏®‡∏∂‡∏Å‡∏©‡∏≤|‡∏Ñ‡∏≤‡∏£|‡∏†‡∏±‡∏è|‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô|‡∏û‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°|‡πÇ‡∏¢‡∏ò‡∏¥‡∏ô|‡πÄ‡∏ã‡∏ô‡∏ï‡πå|GED|‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢|‡∏Ñ‡∏á|‡∏î‡∏∏‡∏á|‡∏™‡∏á|‡πÄ‡∏ó‡∏û|‡πÅ‡∏Å‡πâ‡∏á)[\u0E00-\u0E7F\s]*)\s+([\u0E00-\u0E7F]+)$/);
                
                if (match) {
                    const rank = parseInt(match[1]);
                    const prefix = match[2];
                    const firstName = match[3].trim();
                    const lastName = match[4].trim();
                    const school = match[5].trim();
                    const province = match[6].trim();
                    
                    // ‡∏£‡∏ß‡∏°‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•
                    const fullName = `${firstName} ${lastName}`.trim();
                    
                    students.push({
                        rank: rank,
                        prefix: prefix,
                        name: fullName,
                        school: school,
                        province: province,
                        group: "‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå PDF",
                        fullName: `${prefix} ${fullName}`,
                        searchName: fullName
                    });
                    continue;
                }

                // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà 2: ‡∏ö‡∏≤‡∏á‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡∏≤‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏¢‡∏≤‡∏ß
                match = line.match(/^(\d+)\s+(‡∏ô‡∏≤‡∏¢|‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß|‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢|‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á|‡∏ô\.‡∏™)\s+(.+)/);
                if (match) {
                    const rank = parseInt(match[1]);
                    const prefix = match[2];
                    const remainingText = match[3].trim();
                    
                    // ‡πÅ‡∏¢‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‡∏Å‡∏±‡∏ö ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î
                    // ‡∏´‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ó‡∏µ‡πà‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å
                    const provinces = ['‡πÄ‡∏•‡∏¢', '‡∏™‡∏∏‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå', '‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå', '‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£', '‡∏ö‡∏∏‡∏£‡∏µ‡∏£‡∏±‡∏°‡∏¢‡πå', 
                                    '‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î', '‡∏´‡∏ô‡∏≠‡∏á‡∏Ñ‡∏≤‡∏¢', '‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤', '‡∏ô‡∏Ñ‡∏£‡∏û‡∏ô‡∏°', '‡∏ö‡∏∂‡∏á‡∏Å‡∏≤‡∏¨', '‡∏ä‡∏±‡∏¢‡∏†‡∏π‡∏°‡∏¥',
                                    '‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô', '‡∏°‡∏∏‡∏Å‡∏î‡∏≤‡∏´‡∏≤‡∏£', '‡∏´‡∏ô‡∏≠‡∏á‡∏ö‡∏±‡∏ß‡∏•‡∏≥‡∏†‡∏π'];
                    
                    let province = '';
                    let schoolAndName = remainingText;
                    
                    // ‡∏´‡∏≤‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏à‡∏≤‡∏Å‡∏ó‡πâ‡∏≤‡∏¢‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î
                    for (const prov of provinces) {
                        if (remainingText.endsWith(prov)) {
                            province = prov;
                            schoolAndName = remainingText.substring(0, remainingText.length - prov.length).trim();
                            break;
                        }
                    }
                    
                    if (province) {
                        // ‡πÅ‡∏¢‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏≤‡∏Å‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
                        const schoolKeywords = ['‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤', '‡∏®‡∏∂‡∏Å‡∏©‡∏≤', '‡∏Ñ‡∏≤‡∏£', '‡∏û‡∏¥‡∏ó‡∏¢‡∏≤‡∏Ñ‡∏°', '‡πÇ‡∏¢‡∏ò‡∏¥‡∏ô', '‡πÄ‡∏ã‡∏ô‡∏ï‡πå', '‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°', '‡∏õ‡∏ó‡∏∏‡∏°', '‡∏™‡∏∏‡∏£', '‡∏®‡∏£‡∏µ'];
                        let schoolIndex = -1;
                        
                        for (const keyword of schoolKeywords) {
                            const index = schoolAndName.indexOf(keyword);
                            if (index > 0) {
                                schoolIndex = schoolAndName.lastIndexOf(' ', index);
                                break;
                            }
                        }
                        
                        if (schoolIndex > 0) {
                            const name = schoolAndName.substring(0, schoolIndex).trim();
                            const school = schoolAndName.substring(schoolIndex + 1).trim();
                            
                            if (name.length > 2 && school.length > 2) {
                                students.push({
                                    rank: rank,
                                    prefix: prefix,
                                    name: name,
                                    school: school,
                                    province: province,
                                    group: "‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå PDF",
                                    fullName: `${prefix} ${name}`,
                                    searchName: name
                                });
                            }
                        }
                    }
                }
            }

            return students;
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î
        function showUploadStatus(message, type) {
            const statusDiv = document.getElementById('uploadStatus');
            statusDiv.style.display = 'block';
            statusDiv.className = `upload-status status-${type}`;
            statusDiv.textContent = message;

            if (type !== 'processing') {
                setTimeout(() => {
                    statusDiv.style.display = 'none';
                }, 5000);
            }
        }
    </script>
</body>
</html>
